(function(e){function s(s){for(var n,a,i=s[0],c=s[1],l=s[2],h=0,u=[];h<i.length;h++)a=i[h],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&u.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(s);while(u.length)u.shift()();return r.push.apply(r,l||[]),t()}function t(){for(var e,s=0;s<r.length;s++){for(var t=r[s],n=!0,i=1;i<t.length;i++){var c=t[i];0!==o[c]&&(n=!1)}n&&(r.splice(s--,1),e=a(a.s=t[0]))}return e}var n={},o={app:0},r=[];function a(s){if(n[s])return n[s].exports;var t=n[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=e,a.c=n,a.d=function(e,s,t){a.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,s){if(1&s&&(e=a(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var n in e)a.d(t,n,function(s){return e[s]}.bind(null,n));return t},a.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(s,"a",s),s},a.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},a.p="/web-rtc-demo-app/dist/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=s,i=i.slice();for(var l=0;l<i.length;l++)s(i[l]);var d=c;r.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("cd49")},"034f":function(e,s,t){"use strict";var n=t("85ec"),o=t.n(n);o.a},"0cf6":function(e,s,t){"use strict";var n=t("7086"),o=t.n(n);o.a},2154:function(e,s,t){"use strict";var n=t("ed34"),o=t.n(n);o.a},"21e1":function(e,s,t){},"24d7":function(e,s,t){"use strict";var n=t("21e1"),o=t.n(n);o.a},"543c":function(e,s,t){},7086:function(e,s,t){},"714b":function(e,s,t){"use strict";var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return this.open?t("div",{staticClass:"modal",class:{"is-fixed":e.fixed}},[t("div",{staticClass:"backdrop",on:{click:function(s){return e.$emit("close")}}}),t("div",{staticClass:"dialog"},[t("header",{staticClass:"header"},[e._t("header"),t("span",{staticClass:"close-icon",on:{click:function(s){return e.$emit("close")}}},[e._t("close-icon",[e._v("Ã—")])],2)],2),t("div",{staticClass:"content"},[e._t("default")],2),t("footer",{staticClass:"footer"},[e._t("footer",[t("button",{on:{click:function(s){return e.$emit("close")}}},[e._v("Close")])])],2)])]):e._e()},o=[],r={name:"Modal",props:{open:Boolean,fixed:{type:Boolean,default:!1}}},a=r,i=(t("8f27"),t("2877")),c=Object(i["a"])(a,n,o,!1,null,"65614be0",null);s["a"]=c.exports},"78b4":function(e,s,t){"use strict";t.r(s);var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("main",[t("h1",[e._v(e._s("Session "+e.$route.query.sessionName))]),e.$route.query.serverUrl?e._e():t("Modal",{attrs:{fixed:"",open:""},on:{close:function(s){return e.$router.replace("/")}},scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",[e._v(e._s("Error !"))])]},proxy:!0}],null,!1,2136969466)},[t("p",[e._v(e._s("A server URL is required."))])]),t("Modal",{attrs:{fixed:"",open:!!e.error},on:{close:function(s){e.error=void 0}},scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",[e._v(e._s("An unknown error occurred"))])]},proxy:!0}])},[t("p",[e._v(e._s("This is the error"))]),e.error?t("pre",[e._v("      "+e._s(e.error.message)+"\n      "+e._s(e.error.stack)+"\n    ")]):e._e()]),e.canJoinSession?e.isLocalPeerSetupReady?t("SessionConference",{attrs:{localStream:e.localStream,localPeerId:e.localPeerId}}):t("ManageSessionSetUp",{on:{finish:function(s){e.isLocalPeerSetupReady=!0},localstream:e.onLocalStream}}):t("JoinSession",{on:{canjoinsession:function(s){e.canJoinSession=!0},cannotjoinsession:function(s){return e.$router.replace("/")}}})],1)},o=[],r=t("714b"),a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("h3",[e._v(e._s("Letâ€™s initialize that session dude."))]),e.joinSessionLoading?t("div",[e._v(" "+e._s("Joining the sessionâ€¦")+" ")]):e._e(),t("Modal",{attrs:{fixed:"",open:e.unableToReachServer},on:{close:function(s){e.unableToReachServer=void 0}},scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",[e._v(e._s("Oopsieâ€¦"))])]},proxy:!0}])},[t("p",[e._v(e._s("Looks like the server is taking a nap, we canâ€™t reach itâ€¦"))])]),t("Modal",{attrs:{fixed:"",open:!1===e.canJoinSession},on:{close:function(s){return e.$emit("cannotjoinsession")}},scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",[e._v(e._s("AÃ¯e aÃ¯e aÃ¯e"))])]},proxy:!0}])},[t("p",[e._v(" "+e._s("You cannot join this session. Either this session does not exist, either the URL you were given is wrong.")+" ")])])],1)},i=[],c=t("4670"),l={name:"JoinSession",components:{Modal:r["a"]},data:()=>({joinSessionLoading:!1,unableToReachServer:!1,canJoinSession:void 0}),async mounted(){const{serverUrl:e,password:s,sessionName:t}=this.$route.query,n=new c["a"]({baseUrl:e});if("string"!==typeof t)throw new Error("sessionName should be a string");this.joinSessionLoading=!0;try{const e=await n.joinSession(t,s);this.canJoinSession=e.ok}catch(o){console.error(o),this.unableToReachServer=!0}this.joinSessionLoading=!1,this.canJoinSession&&this.$emit("canjoinsession")}},d=l,h=t("2877"),u=Object(h["a"])(d,a,i,!1,null,null,null),p=u.exports,f=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("ul",{staticStyle:{"text-align":"left","line-height":"2.5em"}},[t("h3",{staticStyle:{margin:"0"}},[e._v(e._s("Before joining the session:"))]),t("li",[e._v(e._s("Accept sharing your audio & video with this us."))]),t("li",[e._v(e._s("Check out your video (below) to see if everything is OK."))]),t("li",[e._v(e._s("If necessary, you can ")),t("button",{on:{click:e.shareVideo}},[e._v(e._s("Re-ask to get your audio & video"))])]),t("li",[e._v(e._s("Share your screen: ")),t("button",{on:{click:e.shareScreen}},[e._v(e._s("Start sharing"))])])]),t("div",[t("video",{key:"local-peer-video",ref:"localPeerVideo",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})]),t("div",{staticStyle:{padding:"2em 0"}},[t("button",{attrs:{disabled:!e.localStream},on:{click:function(s){return e.$emit("finish")}}},[e._v("Letâ€™s go to that conference call")])])])},v=[],m={name:"SessionManageSelfSetUp",components:{},data:()=>({localStream:null}),methods:{async shareVideo(){const e={echoCancellation:!0,noiseSuppression:!0};this.localStream=await window.navigator.mediaDevices.getUserMedia({audio:e,video:e}),this.$refs.localPeerVideo.srcObject=this.localStream,this.$emit("localstream",this.localStream)},async shareScreen(){this.localStream=await window.navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}),this.$refs.localPeerVideo.srcObject=this.localStream,this.$refs.localPeerVideo.addEventListener("suspend",async()=>{await this.shareVideo()})}},mounted(){this.shareVideo()}},g=m,w=Object(h["a"])(g,f,v,!1,null,null,null),b=w.exports,S=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("h3",[e._v(e._s("Conference "+e.$route.query.sessionName+" âˆ’ "+e.localPeerId))]),t("p",[t("button",{on:{click:e.openDrawer}},[e._v(e._s("Open chat"))])]),t("p",[t("button",{on:{click:e.shareScreen}},[e._v(e._s("Share your screen"))])]),t("Drawer",{attrs:{position:"left",open:e.isChatDrawerOpened},on:{close:function(s){e.isChatDrawerOpened=!1}}},[t("div",{staticClass:"chat-messages"},[e._v(" "+e._s(e.console.info("before v-for",{messages:e.messages}))+" "),e._l(e.messages,(function(s,n){return[t("div",{key:n,staticClass:"bubble",class:s.author===e.localPeerId?"local-peer":"remote-peer"},[e._v(" "+e._s(e.console.info("v-for messages",{index:n,data:s}))+" "),t("div",{staticClass:"author"},[e._v(e._s(s.author))]),t("div",[e._v(e._s(s.message))])])]}))],2),t("form",{staticClass:"chat-form",on:{submit:function(s){return s.preventDefault(),e.submitChatMessage(s)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.chatMessage,expression:"chatMessage"}],ref:"chat-input",attrs:{name:"message",placeholder:"Type somethingâ€¦",required:""},domProps:{value:e.chatMessage},on:{input:function(s){s.target.composing||(e.chatMessage=s.target.value)}}}),t("button",{attrs:{type:"submit"}},[e._v(e._s("Send ðŸ‘»"))])])]),t("video",{ref:"local-peer-video",attrs:{playsinline:"",autoplay:""},domProps:{muted:""}}),e._l(e.peers,(function(e){return t("video",{key:e,attrs:{id:"video-"+e,playsinline:"",autoplay:""}})})),e._l(e.peers,(function(s){return[e._v(" "+e._s(e.console.info("v-for peer",{peer:s}))+" ")]}))],2)},_=[],y=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[e.open?t("div",{staticClass:"backdrop",on:{click:function(s){return e.$emit("close")}}}):e._e(),t("div",{class:"drawer drawer-"+this.position+(this.open?" open":"")},[t("span",{staticClass:"close-icon",on:{click:function(s){return e.$emit("close")}}},[e._t("close-icon",[e._v("Ã—")])],2),e._t("default")],2)])},C=[];const P=["left","right"];var E={name:"Drawer",props:{open:Boolean,position:{required:!0,validator:e=>P.includes(e)}}},k=E,I=(t("24d7"),Object(h["a"])(k,y,C,!1,null,"d57e627e",null)),M=I.exports;function x(e){const s=JSON.parse(e.data.toString("utf-8"));switch(s.type){case"chat-message":return s;default:throw new Error("Invalid data message")}}class L extends EventTarget{constructor({dataChannel:e,localPeerId:s}){super(),this.dataChannel=e,this.localPeerId=s,e.addEventListener("open",()=>console.debug("data channel opened",s)),e.addEventListener("close",()=>console.debug("data channel closed",s)),e.addEventListener("error",e=>console.error(e.error)),e.addEventListener("message",e=>{const s=x(e);console.debug("PeerChatAPI: received chat message",s,this),this.dispatchChatMessageEvent(s)})}sendChatMessage(e){const s={type:"chat-message",author:this.localPeerId,message:e};return console.debug("PeerChatAPI: sendMessage",s,this),this.dataChannel.send(JSON.stringify(s)),this.dispatchChatMessageEvent(s),this}dispatchChatMessageEvent(e){this.dispatchEvent(new CustomEvent("chatmessage",{detail:e}))}}const A=[{urls:"stun:stun.stunprotocol.org:3478"},{urls:"turn:137.74.113.202:3478",username:"azfne",credential:"oegiojre"}];class O extends EventTarget{constructor(e){super(),this.localPeerId=e.localPeerId,this.remotePeerId=e.remotePeerId,this.socketAPI=e.socketAPI,this.connection=new RTCPeerConnection({iceServers:A}),this.peerChatAPI=null,this.setLocalStream(e.localStream),this.registerICECandidatesListener(),this.connection.addEventListener("track",e=>{console.debug("PeerConnection: received remote stream"),this.dispatchRemoteStreamEvent(e.streams[0])}),this.connection.addEventListener("datachannel",e=>{console.debug("PeerConnection: received datachannel"),this.setChatDataChannel(e.channel)}),this.connection.addEventListener("connectionstatechange",e=>{switch(console.debug("PeerConnection: connection state change",e,"connection state:",this.connection.connectionState),this.connection.connectionState){case"closed":case"disconnected":case"failed":this.dispatchConnectionCloseEvent();break;default:break}})}setLocalStream(e){this.connection.getSenders().forEach(e=>{console.info("PeerConnection: remove sender",e),this.connection.removeTrack(e)}),e.getTracks().forEach(s=>{console.info("PeerConnection: add track",s,e),this.connection.addTrack(s,e)})}createChatDataChannel(){console.debug("PeerConnection: create and share datachannel"),this.setChatDataChannel(this.connection.createDataChannel("chat",{priority:"high"}))}setChatDataChannel(e){this.peerChatAPI=new L({dataChannel:e,localPeerId:this.localPeerId}),this.dispatchChatApiOpen(this.peerChatAPI),this.addEventListener("connectionclose",()=>{this.peerChatAPI&&this.peerChatAPI.dataChannel.close()})}dispatchChatApiOpen(e){this.dispatchEvent(new CustomEvent("chatapiopen",{detail:e}))}dispatchConnectionCloseEvent(){this.dispatchEvent(new Event("connectionclose"))}dispatchRemoteStreamEvent(e){this.dispatchEvent(new CustomEvent("remotestream",{detail:e}))}registerICECandidatesListener(){this.connection.addEventListener("icecandidate",e=>{e.candidate&&this.socketAPI.send({type:"ice-candidate",candidate:e.candidate,fromPeerId:this.localPeerId,toPeerId:this.remotePeerId})}),this.socketAPI.onIceCandidate(e=>{"ice-candidate"===e.type&&this.connection.addIceCandidate(new RTCIceCandidate(e.candidate)).catch(console.error)})}}new Map;const j={offerToReceiveAudio:!0,offerToReceiveVideo:!0,voiceActivityDetection:!0};class U extends EventTarget{constructor({socketApi:e,localPeerId:s,localStream:t}){super(),this.socketApi=e,this.localPeerId=s,this.localStream=t,this.peerConnections=new Map,e.onConnectedPeersId(e=>this.sendOfferToConnectedPeers(e)),e.onOffer(e=>this.answerToReceivedOffer(e)),e.onAnswer(e=>this.acceptReceivedAnswer(e))}setLocalStream(e){this.peerConnections.forEach(s=>{s.setLocalStream(e)})}closeAllConnections(){this.socketApi.close()}sendChatMessage(e){console.info("peer connections",this.peerConnections),this.peerConnections.forEach(s=>{console.debug("PeersManager: sendChatMessage",e,s,this),s.peerChatAPI?s.peerChatAPI.sendChatMessage(e):window.alert("He-hem, wait a bit")})}getPeerConnection(e){const s=this.peerConnections.get(e);if(!s)throw console.debug("PeersManager: available peer connections",this.peerConnections,this),new Error("No peer connection with remote peer "+e);return s}dispatchPeerConnectionEvent(e){this.dispatchEvent(new CustomEvent("peerconnection",{detail:e}))}dispatchChatMessageEvent(e){this.dispatchEvent(new CustomEvent("chatmessage",{detail:e}))}setPeerConnection(e,s){s.addEventListener("chatapiopen",e=>{const s=e.detail,t=e=>this.dispatchChatMessageEvent(e.detail);s.addEventListener("chatmessage",t),s.dataChannel.addEventListener("close",()=>s.removeEventListener("chatmessage",t))}),this.peerConnections.set(e,s),this.dispatchPeerConnectionEvent(s)}sendOfferToConnectedPeers(e){if("connected-peers-id"!==e.type)throw new Error("Invalid connected peers message");console.debug("PeersManager: connected-peers-id",e,this);const s=e.peerIds.filter(e=>e!==this.localPeerId).map(async e=>{const s=new O({localPeerId:this.localPeerId,remotePeerId:e,localStream:this.localStream,socketAPI:this.socketApi});console.debug("PeersManager: set peer connection with",e,this),this.setPeerConnection(e,s),console.debug("PeersManager: before offer, create chat data channel"),s.createChatDataChannel();const t=await s.connection.createOffer(j);await s.connection.setLocalDescription(t),console.debug("PeersManager: send offer to peer",e,this),this.socketApi.send({type:"offer",description:t,offererId:this.localPeerId,answererId:e})});Promise.all(s).catch(console.error)}async answerToReceivedOffer(e){if("offer"!==e.type)throw new Error("Invalid offer socket message");console.debug("PeersManager: received offer",e,this.peerConnections,this);const s=new O({localPeerId:this.localPeerId,remotePeerId:e.offererId,localStream:this.localStream,socketAPI:this.socketApi});this.setPeerConnection(e.offererId,s),await s.connection.setRemoteDescription(e.description);const t=await s.connection.createAnswer(j);await s.connection.setLocalDescription(t),console.debug('PeersManager: before answer, add listener on "datachannel"'),s.connection.addEventListener("datachannel",e=>{console.debug('PeersManager: "datachannel" event triggered',e,this),"chat"===e.channel.label&&s.setChatDataChannel(e.channel)}),console.debug("PeersManager: send answer",this),this.socketApi.send({type:"answer",answererId:this.localPeerId,offererId:e.offererId,description:t})}acceptReceivedAnswer(e){if("answer"!==e.type)throw new Error("Invalid answer socket message");console.debug("PeersManager: received answer",e,this.peerConnections,this);const s=this.getPeerConnection(e.answererId);s.connection.setRemoteDescription(e.description)}}var $={name:"SessionConference",components:{Drawer:M},props:{localStream:MediaStream,localPeerId:String},data:()=>({isChatDrawerOpened:!1,chatMessage:"",peersManager:null,peers:[],messages:[],console:console}),methods:{submitChatMessage(){console.debug("SessionConference: send message",this.chatMessage,this),this.peersManager.sendChatMessage(this.chatMessage),this.chatMessage=""},onPeerConnection(e){this.peers.push(e.remotePeerId);let s=null;const t=e=>{console.info("Conference: set local remote stream"),s=e.detail};e.addEventListener("remotestream",t),this.$nextTick(()=>{e.removeEventListener("remotestream",t);const n=document.getElementById("video-"+e.remotePeerId);n.srcObject=s,e.addEventListener("remotestream",s=>{console.info("Conference: on remote stream",s,this.$refs,n,"video-"+e.remotePeerId),n.srcObject=s.detail})})},onChatMessage(e){this.messages.push(e)},openDrawer(){this.isChatDrawerOpened=!0,this.$refs["chat-input"].focus()},async shareScreen(){const e=await window.navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}),s=this.$refs["local-peer-video"];s.srcObject=e,this.peersManager.setLocalStream(e),s.addEventListener("suspend",()=>{s.srcObject=this.localStream,this.peersManager.setLocalStream(this.localStream)})}},async mounted(){this.$refs["local-peer-video"].srcObject=this.localStream;const{serverUrl:e,sessionName:s}=this.$route.query,t=new URL(e);t.protocol=window.location.protocol.replace("http","ws");const n=new c["b"]({baseUrl:t.href,sessionName:s,peerId:this.localPeerId});this.peersManager=new U({socketApi:n,localPeerId:this.localPeerId,localStream:this.localStream}),this.peersManager.addEventListener("peerconnection",e=>{this.onPeerConnection(e.detail)}),this.peersManager.addEventListener("chatmessage",e=>{this.onChatMessage(e.detail)})},beforeDestroy(){console.info("beforeDestroy()"),this.peersManager&&this.peersManager.closeAllConnections()}},N=$,R=(t("86b4"),Object(h["a"])(N,S,_,!1,null,null,null)),T=R.exports;function D(){const e=Math.round(1e5*Math.random());return"peer-"+e}var J={name:"Session",components:{Modal:r["a"],JoinSession:p,ManageSessionSetUp:b,SessionConference:T},data:()=>({error:void 0,canJoinSession:void 0,isLocalPeerSetupReady:!1,localStream:null,localPeerId:D()}),async mounted(){console.info("local peer id",this.localPeerId)},errorCaptured(e){this.error=e},methods:{onLocalStream(e){this.localStream=e}}},q=J,W=(t("0cf6"),Object(h["a"])(q,n,o,!1,null,null,null));s["default"]=W.exports},"85ec":function(e,s,t){},"86b4":function(e,s,t){"use strict";var n=t("c5f8"),o=t.n(n);o.a},"8b63":function(e,s,t){"use strict";var n=t("9f4d"),o=t.n(n);o.a},"8f27":function(e,s,t){"use strict";var n=t("543c"),o=t.n(n);o.a},"9f4d":function(e,s,t){},c5f8:function(e,s,t){},cd49:function(e,s,t){"use strict";t.r(s);var n=t("2b0e"),o=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("div",{attrs:{id:"nav"}},[t("router-link",{attrs:{to:"/"}},[e._v("Home")])],1),e.$route.query.sessionName?e._e():t("Home"),e.$route.query.sessionName?t("Session"):e._e()],1)},r=[],a=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("main",{staticClass:"home"},[n("img",{attrs:{alt:"Vue logo",src:t("cf05")}}),n("form",{staticClass:"form",on:{submit:function(s){return s.preventDefault(),e.submit(s)}}},[n("fieldset",[n("legend",[e._v(" Start a conference ")]),n("label",[e._v(" Server URL "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.serverUrl,expression:"serverUrl"}],attrs:{type:"url",required:""},domProps:{value:e.serverUrl},on:{input:function(s){s.target.composing||(e.serverUrl=s.target.value)}}})]),n("label",[e._v(" Session Name "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.sessionName,expression:"sessionName"}],staticClass:"text-input",attrs:{type:"text",required:""},domProps:{value:e.sessionName},on:{input:function(s){s.target.composing||(e.sessionName=s.target.value)}}})]),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.sessionWithPassword,expression:"sessionWithPassword"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.sessionWithPassword)?e._i(e.sessionWithPassword,null)>-1:e.sessionWithPassword},on:{change:function(s){var t=e.sessionWithPassword,n=s.target,o=!!n.checked;if(Array.isArray(t)){var r=null,a=e._i(t,r);n.checked?a<0&&(e.sessionWithPassword=t.concat([r])):a>-1&&(e.sessionWithPassword=t.slice(0,a).concat(t.slice(a+1)))}else e.sessionWithPassword=o}}}),e._v(" Add a password ")]),e.sessionWithPassword?n("label",[e._v(" Password "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"text-input",attrs:{type:"password"},domProps:{value:e.password},on:{input:function(s){s.target.composing||(e.password=s.target.value)}}})]):e._e(),n("hr"),e._m(0)]),n("Modal",{attrs:{fixed:"",open:e.createSessionLoading||e.sessionExistsLoading},on:{close:e.resetForm},scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Loadingâ€¦")])]},proxy:!0},{key:"footer",fn:function(){return[n("p",{staticStyle:{"text-align":"center"}},[e._v("No actions")])]},proxy:!0}])},[e.sessionExistsLoading?n("p",[e._v("Checking if session is available")]):e._e(),e.createSessionLoading?n("p",[e._v("Creating session")]):e._e()]),n("Modal",{attrs:{fixed:"",open:e.sessionExists},on:{close:e.resetForm},scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Sorry!")])]},proxy:!0}])},[n("p",[e._v("This section already exists")])]),n("Modal",{attrs:{fixed:"",open:!1===e.createdSessionSuccessfully},on:{close:e.resetForm},scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Something went wrong")])]},proxy:!0}])},[n("p",[e._v("For an unknown reason, we were unable to create your session. Please try again.")]),n("p",[e._v("If the problem persists, maybe try a bit later. Sorry for the inconvenience.")])]),n("Modal",{attrs:{fixed:"",open:!0===e.unableToReachServer},on:{close:e.resetForm},scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Oopsieâ€¦")])]},proxy:!0}])},[n("p",[e._v("It looks like the server is taking a nap, we canâ€™t reach itâ€¦ :/")])]),n("Modal",{attrs:{fixed:"",open:e.createdSessionSuccessfully},scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Success !")])]},proxy:!0},e.sessionUrl?{key:"footer",fn:function(){return[n("button",{on:{click:function(s){e.$router.push(e.sessionUrl.href.replace(e.sessionUrl.origin,""))}}},[e._v("Letâ€™s go !")])]},proxy:!0}:null],null,!0)},[e.sessionUrl?n("p",[e._v(" Copy the following link to share with your friends: "),n("input",{attrs:{type:"text"},domProps:{value:e.sessionUrl.origin+"/web-rtc-demo-app/dist"+e.sessionUrl.pathname+e.sessionUrl.search+e.sessionUrl.hash}})]):e._e()])],1)])},i=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"form-footer"},[t("button",{attrs:{type:"submit"}},[e._v("Submit")])])}],c=t("714b"),l=t("4670"),d={name:"Home",components:{Modal:c["a"]},data:()=>({sessionName:"",sessionWithPassword:!1,password:"",serverUrl:window.location.origin.includes("localhost")?"http://localhost:43210/":"https://njcyp.sse.codesandbox.io/",sessionUrl:void 0,unableToReachServer:void 0,sessionExistsLoading:!1,sessionExists:void 0,createSessionLoading:!1,createdSessionSuccessfully:void 0}),methods:{async submit(){const e=new l["a"]({baseUrl:this.serverUrl});this.sessionExistsLoading=!0;try{const s=await e.sessionExists(this.sessionName);this.sessionExists=s.ok}catch(s){this.unableToReachServer=!0}if(this.sessionExistsLoading=!1,!this.unableToReachServer&&!this.sessionExists){this.createSessionLoading=!0;try{const s=await e.createSession(this.sessionName,this.password);this.createdSessionSuccessfully=s.ok,this.sessionUrl=new URL("/",window.location.origin),this.sessionUrl.searchParams.set("serverUrl",this.serverUrl),this.sessionUrl.searchParams.set("sessionName",this.sessionName),this.password&&this.sessionUrl.searchParams.set("password",this.password)}catch(s){this.unableToReachServer=!0}this.createSessionLoading=!1}},resetForm(){this.unableToReachServer=void 0,this.sessionUrl=void 0,this.sessionExistsLoading=!1,this.sessionExists=void 0,this.createSessionLoading=!1,this.createdSessionSuccessfully=void 0}}},h=d,u=(t("8b63"),t("2154"),t("2877")),p=Object(u["a"])(h,a,i,!1,null,"b6344a80",null),f=p.exports,v=t("78b4"),m={name:"App",components:{Home:f,Session:v["default"]}},g=m,w=(t("034f"),Object(u["a"])(g,o,r,!1,null,null,null)),b=w.exports,S=t("9483");Object(S["a"])("/web-rtc-demo-app/dist/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var _=t("8c4f");n["a"].use(_["a"]);const y=[{path:"/",name:"Home",component:f},{path:"/sessions/:sessionName",name:"Session",component:()=>Promise.resolve().then(t.bind(null,"78b4"))}],C=new _["a"]({mode:"history",base:"/web-rtc-demo-app/dist/",routes:y});var P=C;n["a"].config.productionTip=!1,new n["a"]({router:P,render:e=>e(b)}).$mount("#app")},cf05:function(e,s,t){e.exports=t.p+"img/logo.82b9c7a5.png"},ed34:function(e,s,t){}});
//# sourceMappingURL=app.6d2924f2.js.map